/**
 * angular-ui-codemirror - This directive allows you to add CodeMirror to your textarea elements.
 * @version v0.0.5 - 2013-10-28
 * @link http://angular-ui.github.com
 * @license MIT
 */
angular.module("ui.codemirror",[]).constant("uiCodemirrorConfig",{}).directive("uiCodemirror",["uiCodemirrorConfig","$timeout",function(a,b){"use strict";var c=["cursorActivity","viewportChange","gutterClick","focus","blur","scroll","update"];return{restrict:"A",require:"?ngModel",link:function(d,e,f,g){var h,i,j,k,l;if("textarea"!==e[0].type)throw new Error("uiCodemirror3 can only be applied to a textarea element");h=a.codemirror||{},i=angular.extend({},h,d.$eval(f.uiCodemirror)),j=function(a){return function(b,c){var e=b.getValue();g&&e!==g.$viewValue&&g.$setViewValue(e),"function"==typeof a&&a(b,c),d.$$phase||d.$apply()}},k=function(){l=CodeMirror.fromTextArea(e[0],i),angular.isDefined(d[f.uiCodemirror])&&d.$watch(f.uiCodemirror,function(a){for(var b in a)a.hasOwnProperty(b)&&l.setOption(b,a[b])},!0),l.on("change",j(i.onChange));for(var a,h=0,k=c.length;k>h;++h)a=i["on"+c[h].charAt(0).toUpperCase()+c[h].slice(1)],void 0!==a&&"function"==typeof a&&l.on(c[h],a);g&&(g.$formatters.push(function(a){if(angular.isUndefined(a)||null===a)return"";if(angular.isObject(a)||angular.isArray(a))throw new Error("ui-codemirror cannot use an object or an array as a model");return a}),g.$parsers.push(function(a){var b=e.next();return b.toggleClass("ng-invalid",!g.$valid).toggleClass("ng-valid",g.$valid).toggleClass("ng-dirty",g.$dirty).toggleClass("ng-pristine",g.$pristine),a}),g.$render=function(){l.setValue(g.$viewValue)},g.$viewValue||(g.$setViewValue(e.text()),g.$render())),f.uiRefresh&&d.$watch(f.uiRefresh,function(a,c){a!==c&&b(function(){l.refresh()})}),angular.isFunction(i.onLoad)&&i.onLoad(l)},b(k)}}}]);